<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5859092930525234"
     crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-REBLDRBN4N"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-REBLDRBN4N');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRC Data | La Crosse Robotics</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,200;1,200&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <link rel="icon" type="image/x-icon" href="/Images/favicon.png">
</head>
<body>

    <header>
        <nav>
            <div class="logo"><a href="index.html">La Crosse <span>Robotics</span></a></div>

            <div class="menu-toggle" id="mobile-menu"><span class="bar"></span><span class="bar"></span><span class="bar"></span></div>
            <ul class="nav-list">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a href="calendar.html">Calendar</a></li>
                <li><a href="sponsors.html">Sponsors</a></li>
                <li><a href="photos.html">Photos</a></li>
            </ul>
        </nav>
    </header>

    <section class="frc-data-section">
        <div class="container">
            <h1 class="fade-in">FRC Live Data</h1>
            <p class="subtitle fade-in">Real-time data from FIRST Robotics Competition events</p>

            <!-- API Configuration -->
            <div class="frc-config-card fade-in">
                <h2>API Configuration</h2>
                <div class="config-group">
                    <label for="frc-username">Username:</label>
                    <input type="text" id="frc-username" placeholder="Enter your FRC API username" value="crose4054">
                </div>
                <div class="config-group">
                    <label for="frc-auth-key">Authorization Key:</label>
                    <input type="password" id="frc-auth-key" placeholder="Enter your authorization key" value="ee92092f-3ebb-469d-be15-b420cd4abd96">
                </div>
                <div class="config-info">
                    <p>Get your API credentials at <a href="https://frc-events.firstinspires.org/services/API" target="_blank">FRC Events API</a></p>
                    <p class="warning">⚠️ Your credentials are stored locally in your browser only</p>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="frc-tabs fade-in">
                <button class="frc-tab active" data-tab="season">Season Info</button>
                <button class="frc-tab" data-tab="events">Events</button>
                <button class="frc-tab" data-tab="team">Team Lookup</button>
                <button class="frc-tab" data-tab="matches">Match Results</button>
                <button class="frc-tab" data-tab="rankings">Rankings</button>
                <button class="frc-tab" data-tab="awards">Awards</button>
                <button class="frc-tab" data-tab="alliances">Alliances</button>
                <button class="frc-tab" data-tab="districts">Districts</button>
            </div>

            <!-- Season Info Tab -->
            <div class="frc-tab-content active" id="season-tab">
                <div class="frc-card">
                    <h2>Season Information</h2>
                    <div class="input-group">
                        <input type="number" id="season-year" placeholder="Year (e.g., 2024)" value="2024">
                        <button onclick="fetchSeasonData()" class="btn">Get Season Data</button>
                    </div>
                    <div id="season-results" class="results-container"></div>
                </div>
            </div>

            <!-- Events Tab -->
            <div class="frc-tab-content" id="events-tab">
                <div class="frc-card">
                    <h2>Event Listings</h2>
                    <div class="input-group">
                        <input type="number" id="events-year" placeholder="Year (e.g., 2024)" value="2024">
                        <select id="event-type">
                            <option value="">All Events</option>
                            <option value="regional">Regional</option>
                            <option value="district">District</option>
                            <option value="championship">Championship</option>
                        </select>
                        <button onclick="fetchEvents()" class="btn">Get Events</button>
                    </div>
                    <div id="events-results" class="results-container"></div>
                </div>
            </div>

            <!-- Team Lookup Tab -->
            <div class="frc-tab-content" id="team-tab">
                <div class="frc-card">
                    <h2>Team Information</h2>
                    <div class="input-group">
                        <input type="number" id="team-number" placeholder="Team Number (e.g., 4054)" value="4054">
                        <input type="number" id="team-year" placeholder="Year (e.g., 2024)" value="2024">
                        <button onclick="fetchTeamData()" class="btn">Get Team Data</button>
                    </div>
                    <div id="team-results" class="results-container"></div>
                </div>
            </div>

            <!-- Match Results Tab -->
            <div class="frc-tab-content" id="matches-tab">
                <div class="frc-card">
                    <h2>Match Results</h2>
                    <div class="input-group">
                        <input type="number" id="match-year" placeholder="Year (e.g., 2024)" value="2024">
                        <input type="text" id="event-code" placeholder="Event Code (e.g., WIMI)">
                        <button onclick="fetchMatches()" class="btn">Get Matches</button>
                    </div>
                    <div id="matches-results" class="results-container"></div>
                </div>
            </div>

            <!-- Rankings Tab -->
            <div class="frc-tab-content" id="rankings-tab">
                <div class="frc-card">
                    <h2>Event Rankings</h2>
                    <div class="input-group">
                        <input type="number" id="rankings-year" placeholder="Year (e.g., 2024)" value="2024">
                        <input type="text" id="rankings-event-code" placeholder="Event Code (e.g., WIMI)">
                        <button onclick="fetchRankings()" class="btn">Get Rankings</button>
                    </div>
                    <div id="rankings-results" class="results-container"></div>
                </div>
            </div>

            <!-- Awards Tab -->
            <div class="frc-tab-content" id="awards-tab">
                <div class="frc-card">
                    <h2>Event Awards</h2>
                    <div class="input-group">
                        <input type="number" id="awards-year" placeholder="Year (e.g., 2024)" value="2024">
                        <input type="text" id="awards-event-code" placeholder="Event Code (e.g., WIMI)">
                        <input type="number" id="awards-team" placeholder="Team Number (optional)">
                        <button onclick="fetchAwards()" class="btn">Get Awards</button>
                    </div>
                    <div id="awards-results" class="results-container"></div>
                </div>
            </div>

            <!-- Alliances Tab -->
            <div class="frc-tab-content" id="alliances-tab">
                <div class="frc-card">
                    <h2>Alliance Selection</h2>
                    <div class="input-group">
                        <input type="number" id="alliances-year" placeholder="Year (e.g., 2024)" value="2024">
                        <input type="text" id="alliances-event-code" placeholder="Event Code (e.g., WIMI)">
                        <button onclick="fetchAlliances()" class="btn">Get Alliances</button>
                    </div>
                    <div id="alliances-results" class="results-container"></div>
                </div>
            </div>

            <!-- Districts Tab -->
            <div class="frc-tab-content" id="districts-tab">
                <div class="frc-card">
                    <h2>District Information</h2>
                    <div class="input-group">
                        <input type="number" id="districts-year" placeholder="Year (e.g., 2024)" value="2024">
                        <button onclick="fetchDistricts()" class="btn">Get Districts</button>
                    </div>
                    <div id="districts-results" class="results-container"></div>
                </div>
                <div class="frc-card" style="margin-top: 20px;">
                    <h2>District Rankings</h2>
                    <div class="input-group">
                        <input type="number" id="district-rankings-year" placeholder="Year (e.g., 2024)" value="2024">
                        <input type="text" id="district-code" placeholder="District Code (e.g., FIM)">
                        <button onclick="fetchDistrictRankings()" class="btn">Get District Rankings</button>
                    </div>
                    <div id="district-rankings-results" class="results-container"></div>
                </div>
            </div>

        </div>
    </section>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 La Crosse Robotics | Team 4054 The Aeronauts</p>
            <div class="social-links">
                <a href="https://www.facebook.com/LaCrosseRoboticsClub" target="_blank">Facebook</a>
                <a href="https://www.instagram.com/lacrosserobotics/" target="_blank">Instagram</a>
            </div>
        </div>
    </footer>

    <script>
        // FRC API Handler
        const FRC_API_BASE = 'https://frc-api.firstinspires.org/v3.0';
        
        // Load credentials from localStorage
        function loadCredentials() {
            const username = localStorage.getItem('frc-username');
            const authKey = localStorage.getItem('frc-auth-key');
            if (username) document.getElementById('frc-username').value = username;
            if (authKey) document.getElementById('frc-auth-key').value = authKey;
            return { username, authKey };
        }

        // Save credentials to localStorage
        function saveCredentials() {
            const username = document.getElementById('frc-username').value;
            const authKey = document.getElementById('frc-auth-key').value;
            if (username) localStorage.setItem('frc-username', username);
            if (authKey) localStorage.setItem('frc-auth-key', authKey);
            return { username, authKey };
        }

        // Generate Authorization Header
        function getAuthHeader() {
            const { username, authKey } = saveCredentials();
            if (!username || !authKey) {
                throw new Error('Please enter your API credentials');
            }
            const token = btoa(`${username}:${authKey}`);
            return `Basic ${token}`;
        }

        // Generic API fetch function
        async function fetchFRCData(endpoint, resultsElementId) {
            const resultsDiv = document.getElementById(resultsElementId);
            resultsDiv.innerHTML = '<div class="loading">Loading...</div>';
            
            try {
                const authHeader = getAuthHeader();
                const response = await fetch(`${FRC_API_BASE}${endpoint}`, {
                    headers: {
                        'Authorization': authHeader,
                        'Accept': 'application/json'
                    }
                });

                if (response.status === 304) {
                    resultsDiv.innerHTML = '<div class="info-message">No new data since last request</div>';
                    return;
                }

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                return data;

            } catch (error) {
                resultsDiv.innerHTML = `<div class="error-message">Error: ${error.message}</div>`;
                console.error('FRC API Error:', error);
                return null;
            }
        }

        // Fetch Season Data
        async function fetchSeasonData() {
            const year = document.getElementById('season-year').value;
            if (!year) {
                alert('Please enter a year');
                return;
            }

            const data = await fetchFRCData(`/${year}`, 'season-results');
            if (data) {
                let html = '<div class="data-display">';
                html += `<h3>Season ${year}</h3>`;
                html += `<div class="data-grid">`;
                html += `<div class="data-item"><strong>Event Count:</strong> ${data.eventCount || 'N/A'}</div>`;
                html += `<div class="data-item"><strong>Game Name:</strong> ${data.gameName || 'N/A'}</div>`;
                html += `<div class="data-item"><strong>Kickoff:</strong> ${data.kickoff ? new Date(data.kickoff).toLocaleDateString() : 'N/A'}</div>`;
                html += `</div></div>`;
                document.getElementById('season-results').innerHTML = html;
            }
        }

        // Fetch Events
        async function fetchEvents() {
            const year = document.getElementById('events-year').value;
            const eventType = document.getElementById('event-type').value;
            
            if (!year) {
                alert('Please enter a year');
                return;
            }

            let endpoint = `/${year}/events`;
            if (eventType) endpoint += `?eventType=${eventType}`;

            const data = await fetchFRCData(endpoint, 'events-results');
            if (data && data.Events) {
                let html = '<div class="data-display"><h3>Events</h3><div class="events-list">';
                
                data.Events.forEach(event => {
                    html += `<div class="event-card">`;
                    html += `<h4>${event.name}</h4>`;
                    html += `<p><strong>Code:</strong> ${event.code}</p>`;
                    html += `<p><strong>Type:</strong> ${event.type || 'N/A'}</p>`;
                    html += `<p><strong>Location:</strong> ${event.city || ''}, ${event.stateprov || ''} ${event.country || ''}</p>`;
                    html += `<p><strong>Dates:</strong> ${event.dateStart ? new Date(event.dateStart).toLocaleDateString() : 'TBA'} - ${event.dateEnd ? new Date(event.dateEnd).toLocaleDateString() : 'TBA'}</p>`;
                    html += `</div>`;
                });
                
                html += '</div></div>';
                document.getElementById('events-results').innerHTML = html;
            }
        }

        // Fetch Team Data
        async function fetchTeamData() {
            const teamNumber = document.getElementById('team-number').value;
            const year = document.getElementById('team-year').value;
            
            if (!teamNumber || !year) {
                alert('Please enter both team number and year');
                return;
            }

            const data = await fetchFRCData(`/${year}/teams?teamNumber=${teamNumber}`, 'team-results');
            if (data && data.teams && data.teams.length > 0) {
                const team = data.teams[0];
                let html = '<div class="data-display">';
                html += `<h3>Team ${team.teamNumber}</h3>`;
                html += `<div class="data-grid">`;
                html += `<div class="data-item"><strong>Name:</strong> ${team.nameFull || 'N/A'}</div>`;
                html += `<div class="data-item"><strong>Nickname:</strong> ${team.nameShort || 'N/A'}</div>`;
                html += `<div class="data-item"><strong>Rookie Year:</strong> ${team.rookieYear || 'N/A'}</div>`;
                html += `<div class="data-item"><strong>Location:</strong> ${team.city || ''}, ${team.stateProv || ''} ${team.country || ''}</div>`;
                html += `<div class="data-item"><strong>School:</strong> ${team.schoolName || 'N/A'}</div>`;
                html += `<div class="data-item"><strong>Website:</strong> ${team.website ? `<a href="${team.website}" target="_blank">${team.website}</a>` : 'N/A'}</div>`;
                html += `</div></div>`;
                document.getElementById('team-results').innerHTML = html;
            } else {
                document.getElementById('team-results').innerHTML = '<div class="info-message">No team data found</div>';
            }
        }

        // Fetch Match Results
        async function fetchMatches() {
            const year = document.getElementById('match-year').value;
            const eventCode = document.getElementById('event-code').value;
            
            if (!year || !eventCode) {
                alert('Please enter both year and event code');
                return;
            }

            const data = await fetchFRCData(`/${year}/${eventCode}/matches`, 'matches-results');
            if (data && data.Matches) {
                let html = '<div class="data-display"><h3>Match Results</h3><div class="matches-list">';
                
                data.Matches.forEach(match => {
                    html += `<div class="match-card">`;
                    html += `<h4>${match.description || 'Match'} #${match.matchNumber}</h4>`;
                    html += `<div class="match-alliances">`;
                    
                    // Red Alliance
                    if (match.teams) {
                        html += `<div class="alliance red-alliance">`;
                        html += `<strong>Red Alliance</strong>`;
                        const redTeams = match.teams.filter(t => t.station.startsWith('Red'));
                        redTeams.forEach(t => html += `<p>Team ${t.teamNumber} (${t.station})</p>`);
                        html += `</div>`;
                        
                        // Blue Alliance
                        html += `<div class="alliance blue-alliance">`;
                        html += `<strong>Blue Alliance</strong>`;
                        const blueTeams = match.teams.filter(t => t.station.startsWith('Blue'));
                        blueTeams.forEach(t => html += `<p>Team ${t.teamNumber} (${t.station})</p>`);
                        html += `</div>`;
                    }
                    
                    html += `</div>`;
                    
                    // Scores
                    if (match.scoreRedFinal !== undefined && match.scoreBlueFinal !== undefined) {
                        html += `<div class="match-score">`;
                        html += `<p><strong>Final Score:</strong> Red ${match.scoreRedFinal} - Blue ${match.scoreBlueFinal}</p>`;
                        html += `</div>`;
                    }
                    
                    html += `</div>`;
                });
                
                html += '</div></div>';
                document.getElementById('matches-results').innerHTML = html;
            } else {
                document.getElementById('matches-results').innerHTML = '<div class="info-message">No match data found</div>';
            }
        }

        // Fetch Rankings
        async function fetchRankings() {
            const year = document.getElementById('rankings-year').value;
            const eventCode = document.getElementById('rankings-event-code').value;
            
            if (!year || !eventCode) {
                alert('Please enter both year and event code');
                return;
            }

            const data = await fetchFRCData(`/${year}/${eventCode}/rankings`, 'rankings-results');
            if (data && data.Rankings) {
                let html = '<div class="data-display"><h3>Event Rankings</h3>';
                html += '<div class="rankings-table-wrapper">';
                html += '<table class="rankings-table">';
                html += '<thead><tr>';
                html += '<th>Rank</th><th>Team</th><th>Record (W-L-T)</th>';
                html += '<th>Ranking Points</th><th>Matches Played</th></tr></thead><tbody>';
                
                data.Rankings.forEach(rank => {
                    html += '<tr>';
                    html += `<td><strong>${rank.rank}</strong></td>`;
                    html += `<td>Team ${rank.teamNumber}</td>`;
                    html += `<td>${rank.wins || 0}-${rank.losses || 0}-${rank.ties || 0}</td>`;
                    html += `<td>${rank.sortOrder1 !== undefined ? rank.sortOrder1.toFixed(2) : 'N/A'}</td>`;
                    html += `<td>${rank.matchesPlayed || 0}</td>`;
                    html += '</tr>';
                });
                
                html += '</tbody></table></div></div>';
                document.getElementById('rankings-results').innerHTML = html;
            } else {
                document.getElementById('rankings-results').innerHTML = '<div class="info-message">No rankings data found</div>';
            }
        }

        // Fetch Awards
        async function fetchAwards() {
            const year = document.getElementById('awards-year').value;
            const eventCode = document.getElementById('awards-event-code').value;
            const teamNumber = document.getElementById('awards-team').value;
            
            if (!year || !eventCode) {
                alert('Please enter both year and event code');
                return;
            }

            let endpoint = `/${year}/${eventCode}/awards`;
            if (teamNumber) endpoint += `?teamNumber=${teamNumber}`;

            const data = await fetchFRCData(endpoint, 'awards-results');
            if (data && data.Awards) {
                let html = '<div class="data-display"><h3>Awards</h3><div class="awards-list">';
                
                data.Awards.forEach(award => {
                    html += `<div class="award-card">`;
                    html += `<h4>${award.name}</h4>`;
                    if (award.teamNumber) {
                        html += `<p><strong>Team:</strong> ${award.teamNumber}</p>`;
                    }
                    if (award.person) {
                        html += `<p><strong>Recipient:</strong> ${award.person}</p>`;
                    }
                    html += `</div>`;
                });
                
                html += '</div></div>';
                document.getElementById('awards-results').innerHTML = html;
            } else {
                document.getElementById('awards-results').innerHTML = '<div class="info-message">No awards data found</div>';
            }
        }

        // Fetch Alliances
        async function fetchAlliances() {
            const year = document.getElementById('alliances-year').value;
            const eventCode = document.getElementById('alliances-event-code').value;
            
            if (!year || !eventCode) {
                alert('Please enter both year and event code');
                return;
            }

            const data = await fetchFRCData(`/${year}/${eventCode}/alliances`, 'alliances-results');
            if (data && data.Alliances) {
                let html = '<div class="data-display"><h3>Alliance Selection</h3><div class="alliances-grid">';
                
                data.Alliances.forEach((alliance, index) => {
                    html += `<div class="alliance-card">`;
                    html += `<h4>Alliance ${index + 1}</h4>`;
                    html += `<p><strong>Captain:</strong> Team ${alliance.captain || 'N/A'}</p>`;
                    if (alliance.round1) html += `<p><strong>Pick 1:</strong> Team ${alliance.round1}</p>`;
                    if (alliance.round2) html += `<p><strong>Pick 2:</strong> Team ${alliance.round2}</p>`;
                    if (alliance.round3) html += `<p><strong>Pick 3:</strong> Team ${alliance.round3}</p>`;
                    if (alliance.backup) html += `<p><strong>Backup:</strong> Team ${alliance.backup}</p>`;
                    html += `</div>`;
                });
                
                html += '</div></div>';
                document.getElementById('alliances-results').innerHTML = html;
            } else {
                document.getElementById('alliances-results').innerHTML = '<div class="info-message">No alliance data found</div>';
            }
        }

        // Fetch Districts
        async function fetchDistricts() {
            const year = document.getElementById('districts-year').value;
            
            if (!year) {
                alert('Please enter a year');
                return;
            }

            const data = await fetchFRCData(`/${year}/districts`, 'districts-results');
            if (data && data.districts) {
                let html = '<div class="data-display"><h3>Districts</h3><div class="districts-grid">';
                
                data.districts.forEach(district => {
                    html += `<div class="district-card">`;
                    html += `<h4>${district.name}</h4>`;
                    html += `<p><strong>Code:</strong> ${district.code}</p>`;
                    html += `</div>`;
                });
                
                html += '</div></div>';
                document.getElementById('districts-results').innerHTML = html;
            } else {
                document.getElementById('districts-results').innerHTML = '<div class="info-message">No districts data found</div>';
            }
        }

        // Fetch District Rankings
        async function fetchDistrictRankings() {
            const year = document.getElementById('district-rankings-year').value;
            const districtCode = document.getElementById('district-code').value;
            
            if (!year || !districtCode) {
                alert('Please enter both year and district code');
                return;
            }

            const data = await fetchFRCData(`/${year}/rankings/${districtCode}`, 'district-rankings-results');
            if (data && data.districtRanks) {
                let html = '<div class="data-display"><h3>District Rankings</h3>';
                html += '<div class="rankings-table-wrapper">';
                html += '<table class="rankings-table">';
                html += '<thead><tr>';
                html += '<th>Rank</th><th>Team</th><th>Total Points</th>';
                html += '<th>Event 1</th><th>Event 2</th><th>DCMP</th></tr></thead><tbody>';
                
                data.districtRanks.forEach(rank => {
                    html += '<tr>';
                    html += `<td><strong>${rank.rank}</strong></td>`;
                    html += `<td>Team ${rank.teamNumber}</td>`;
                    html += `<td>${rank.totalPoints || 0}</td>`;
                    html += `<td>${rank.event1Points || 0}</td>`;
                    html += `<td>${rank.event2Points || 0}</td>`;
                    html += `<td>${rank.districtCmpPoints || 0}</td>`;
                    html += '</tr>';
                });
                
                html += '</tbody></table></div></div>';
                document.getElementById('district-rankings-results').innerHTML = html;
            } else {
                document.getElementById('district-rankings-results').innerHTML = '<div class="info-message">No district rankings data found</div>';
            }
        }

        // Tab switching
        document.querySelectorAll('.frc-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and contents
                document.querySelectorAll('.frc-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.frc-tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                const tabName = tab.getAttribute('data-tab');
                document.getElementById(`${tabName}-tab`).classList.add('active');
            });
        });

        // Load credentials on page load
        window.addEventListener('DOMContentLoaded', loadCredentials);
    </script>

</body>
</html>
